{"ast":null,"code":"// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\nexport default class Serializer {\n  constructor() {\n    this.HEADER_LENGTH = 1;\n  }\n\n  decode(rawPayload, callback) {\n    if (rawPayload.constructor === ArrayBuffer) {\n      return callback(this._binaryDecode(rawPayload));\n    }\n\n    if (typeof rawPayload === 'string') {\n      return callback(JSON.parse(rawPayload));\n    }\n\n    return callback({});\n  }\n\n  _binaryDecode(buffer) {\n    const view = new DataView(buffer);\n    const decoder = new TextDecoder();\n    return this._decodeBroadcast(buffer, view, decoder);\n  }\n\n  _decodeBroadcast(buffer, view, decoder) {\n    const topicSize = view.getUint8(1);\n    const eventSize = view.getUint8(2);\n    let offset = this.HEADER_LENGTH + 2;\n    const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n    offset = offset + topicSize;\n    const event = decoder.decode(buffer.slice(offset, offset + eventSize));\n    offset = offset + eventSize;\n    const data = JSON.parse(decoder.decode(buffer.slice(offset, buffer.byteLength)));\n    return {\n      ref: null,\n      topic: topic,\n      event: event,\n      payload: data\n    };\n  }\n\n}","map":{"version":3,"names":["Serializer","constructor","HEADER_LENGTH","decode","rawPayload","callback","ArrayBuffer","_binaryDecode","JSON","parse","buffer","view","DataView","decoder","TextDecoder","_decodeBroadcast","topicSize","getUint8","eventSize","offset","topic","slice","event","data","byteLength","ref","payload"],"sources":["C:/Users/Sergipetec/Documents/supabase-angular/node_modules/@supabase/realtime-js/dist/module/lib/serializer.js"],"sourcesContent":["// This file draws heavily from https://github.com/phoenixframework/phoenix/commit/cf098e9cf7a44ee6479d31d911a97d3c7430c6fe\n// License: https://github.com/phoenixframework/phoenix/blob/master/LICENSE.md\nexport default class Serializer {\n    constructor() {\n        this.HEADER_LENGTH = 1;\n    }\n    decode(rawPayload, callback) {\n        if (rawPayload.constructor === ArrayBuffer) {\n            return callback(this._binaryDecode(rawPayload));\n        }\n        if (typeof rawPayload === 'string') {\n            return callback(JSON.parse(rawPayload));\n        }\n        return callback({});\n    }\n    _binaryDecode(buffer) {\n        const view = new DataView(buffer);\n        const decoder = new TextDecoder();\n        return this._decodeBroadcast(buffer, view, decoder);\n    }\n    _decodeBroadcast(buffer, view, decoder) {\n        const topicSize = view.getUint8(1);\n        const eventSize = view.getUint8(2);\n        let offset = this.HEADER_LENGTH + 2;\n        const topic = decoder.decode(buffer.slice(offset, offset + topicSize));\n        offset = offset + topicSize;\n        const event = decoder.decode(buffer.slice(offset, offset + eventSize));\n        offset = offset + eventSize;\n        const data = JSON.parse(decoder.decode(buffer.slice(offset, buffer.byteLength)));\n        return { ref: null, topic: topic, event: event, payload: data };\n    }\n}\n"],"mappings":"AAAA;AACA;AACA,eAAe,MAAMA,UAAN,CAAiB;EAC5BC,WAAW,GAAG;IACV,KAAKC,aAAL,GAAqB,CAArB;EACH;;EACDC,MAAM,CAACC,UAAD,EAAaC,QAAb,EAAuB;IACzB,IAAID,UAAU,CAACH,WAAX,KAA2BK,WAA/B,EAA4C;MACxC,OAAOD,QAAQ,CAAC,KAAKE,aAAL,CAAmBH,UAAnB,CAAD,CAAf;IACH;;IACD,IAAI,OAAOA,UAAP,KAAsB,QAA1B,EAAoC;MAChC,OAAOC,QAAQ,CAACG,IAAI,CAACC,KAAL,CAAWL,UAAX,CAAD,CAAf;IACH;;IACD,OAAOC,QAAQ,CAAC,EAAD,CAAf;EACH;;EACDE,aAAa,CAACG,MAAD,EAAS;IAClB,MAAMC,IAAI,GAAG,IAAIC,QAAJ,CAAaF,MAAb,CAAb;IACA,MAAMG,OAAO,GAAG,IAAIC,WAAJ,EAAhB;IACA,OAAO,KAAKC,gBAAL,CAAsBL,MAAtB,EAA8BC,IAA9B,EAAoCE,OAApC,CAAP;EACH;;EACDE,gBAAgB,CAACL,MAAD,EAASC,IAAT,EAAeE,OAAf,EAAwB;IACpC,MAAMG,SAAS,GAAGL,IAAI,CAACM,QAAL,CAAc,CAAd,CAAlB;IACA,MAAMC,SAAS,GAAGP,IAAI,CAACM,QAAL,CAAc,CAAd,CAAlB;IACA,IAAIE,MAAM,GAAG,KAAKjB,aAAL,GAAqB,CAAlC;IACA,MAAMkB,KAAK,GAAGP,OAAO,CAACV,MAAR,CAAeO,MAAM,CAACW,KAAP,CAAaF,MAAb,EAAqBA,MAAM,GAAGH,SAA9B,CAAf,CAAd;IACAG,MAAM,GAAGA,MAAM,GAAGH,SAAlB;IACA,MAAMM,KAAK,GAAGT,OAAO,CAACV,MAAR,CAAeO,MAAM,CAACW,KAAP,CAAaF,MAAb,EAAqBA,MAAM,GAAGD,SAA9B,CAAf,CAAd;IACAC,MAAM,GAAGA,MAAM,GAAGD,SAAlB;IACA,MAAMK,IAAI,GAAGf,IAAI,CAACC,KAAL,CAAWI,OAAO,CAACV,MAAR,CAAeO,MAAM,CAACW,KAAP,CAAaF,MAAb,EAAqBT,MAAM,CAACc,UAA5B,CAAf,CAAX,CAAb;IACA,OAAO;MAAEC,GAAG,EAAE,IAAP;MAAaL,KAAK,EAAEA,KAApB;MAA2BE,KAAK,EAAEA,KAAlC;MAAyCI,OAAO,EAAEH;IAAlD,CAAP;EACH;;AA5B2B"},"metadata":{},"sourceType":"module"}